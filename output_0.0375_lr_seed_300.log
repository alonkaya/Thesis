nohup: ignoring input
/home/aviran/miniconda3/envs/alon_env/lib/python3.9/site-packages/transformers/utils/generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
/home/aviran/miniconda3/envs/alon_env/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/aviran/miniconda3/envs/alon_env/lib/python3.9/site-packages/transformers/modeling_utils.py:479: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location=map_location)
/home/aviran/Alon/Thesis/FMatrixRegressor.py:307: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location='cpu')
###########################################################################################################################################################

                         learning rate: 4e-05, lr_decay: 0.85, mlp_hidden_sizes: [1024, 512], jump_frames: 2, use_reconstruction_layer: True
                        batch_size: 8, norm: True, train_seqeunces: [0, 2, 3, 5], val_sequences: [6, 7, 8], dataset: Stereo,
                        average embeddings: False, model: openai/clip-vit-base-patch32, augmentation: True, random crop: True, deepF_nocorrs: False, part: tail, get_old_path: False,
                        SVD coeff: 0, RE1 coeff: 0 SED coeff: 0.5, ALG_COEFF: 0, L2_coeff: 1, huber_coeff: 1, frozen layers: 4, trained vit: plots/Affine/BS_32__lr_6e-05__train_size_9216__CLIP__alpha_10__conv__original_rotated/model.pth,
                        crop: 224 resize: 256, use conv: False pretrained: None, data_ratio: 0.0375, norm_mean: tensor([0.4815, 0.4578, 0.4082], device='cuda:0'), norm_std: tensor([0.2686, 0.2613, 0.2758], device='cuda:0'), sched: None seed: 300, 


##### CONTINUE TRAINING #####


Epoch 6143/9000: Training Loss: 0.28331653744566676		 Val Loss: 1.8857924143473308
             Training MAE: 0.05477859452366829		 Val MAE: 0.07000844925642014
             Algebraic dist: 0.5159179089116115		 Val Algebraic dist: 1.263588375515408
             RE1 dist: 0.2727009081373028		 Val RE1 dist: 2.2509047190348306
             SED dist: 0.5412070330451516		 Val SED dist: 3.7365184360080295


Epoch 6144/9000: Training Loss: 0.24941390168433095		 Val Loss: 0.9300277498033311
             Training MAE: 0.058075301349163055		 Val MAE: 0.06358161568641663
             Algebraic dist: 0.4840109956030752		 Val Algebraic dist: 0.8552304373847114
             RE1 dist: 0.2387202580769857		 Val RE1 dist: 0.8866192499796549
             SED dist: 0.4709306978711895		 Val SED dist: 1.8304945627848308


Epoch 6145/9000: Training Loss: 0.2769858042399089		 Val Loss: 1.324862904018826
             Training MAE: 0.05576568469405174		 Val MAE: 0.05840863287448883
             Algebraic dist: 0.5074257570154527		 Val Algebraic dist: 1.092196570502387
             RE1 dist: 0.26208589591232		 Val RE1 dist: 1.4850909974839952
             SED dist: 0.5278904110777611		 Val SED dist: 2.6231439378526478


Epoch 6146/9000: Training Loss: 0.2115480011584712		 Val Loss: 0.9960048463609483
             Training MAE: 0.059121593832969666		 Val MAE: 0.055464476346969604
             Algebraic dist: 0.4323982163971546		 Val Algebraic dist: 1.029330571492513
             RE1 dist: 0.1954976437138576		 Val RE1 dist: 0.8944302664862739
             SED dist: 0.39423276863846124		 Val SED dist: 1.967182371351454


Epoch 6147/9000: Training Loss: 0.2972397710762772		 Val Loss: 1.4976364771525066
             Training MAE: 0.06130928918719292		 Val MAE: 0.058414701372385025
             Algebraic dist: 0.5139752556295956		 Val Algebraic dist: 1.1321768230862088
             RE1 dist: 0.2734755347756779		 Val RE1 dist: 1.7144269943237305
             SED dist: 0.5635562223546645		 Val SED dist: 2.968510945638021


Epoch 6148/9000: Training Loss: 0.22047598221722772		 Val Loss: 0.9062899483574761
             Training MAE: 0.060509443283081055		 Val MAE: 0.052761297672986984
             Algebraic dist: 0.42526544309129904		 Val Algebraic dist: 0.8486750390794542
             RE1 dist: 0.18590652241426356		 Val RE1 dist: 0.7829756736755371
             SED dist: 0.4103887969372319		 Val SED dist: 1.7889662848578558


Epoch 6149/9000: Training Loss: 0.4668595183129404		 Val Loss: 1.7238002353244357
             Training MAE: 0.060452651232481		 Val MAE: 0.06292648613452911
             Algebraic dist: 0.7257588704427084		 Val Algebraic dist: 1.3338324228922527
             RE1 dist: 0.5131653056425207		 Val RE1 dist: 1.9082842932807074
             SED dist: 0.90418789433498		 Val SED dist: 3.418126424153646


Epoch 6150/9000: Training Loss: 0.27649567173976525		 Val Loss: 1.8747812906901042
             Training MAE: 0.05679645761847496		 Val MAE: 0.05663978308439255
             Algebraic dist: 0.5116332559024587		 Val Algebraic dist: 1.2604953977796767
             RE1 dist: 0.26308925479066136		 Val RE1 dist: 1.96576902601454
             SED dist: 0.5252077439252067		 Val SED dist: 3.724090152316623


Epoch 6151/9000: Training Loss: 0.2812968422384823		 Val Loss: 1.666968133714464
             Training MAE: 0.05864732339978218		 Val MAE: 0.05401192232966423
             Algebraic dist: 0.533883300482058		 Val Algebraic dist: 1.238740709092882
             RE1 dist: 0.28626711228314566		 Val RE1 dist: 2.0657535129123263
             SED dist: 0.5339593700334138		 Val SED dist: 3.309726079305013


Epoch 6152/9000: Training Loss: 0.2612150977639591		 Val Loss: 1.1608155568440754
             Training MAE: 0.05796787142753601		 Val MAE: 0.05253298953175545
             Algebraic dist: 0.4918359120686849		 Val Algebraic dist: 0.9460701412624783
             RE1 dist: 0.24846834294936238		 Val RE1 dist: 1.2066904703776042
             SED dist: 0.49302063736261104		 Val SED dist: 2.2980452643500433


Epoch 6153/9000: Training Loss: 0.31300125870050166		 Val Loss: 1.1627688937717013
             Training MAE: 0.06064996123313904		 Val MAE: 0.05449678376317024
             Algebraic dist: 0.5435915554271025		 Val Algebraic dist: 1.090165032280816
             RE1 dist: 0.3018627727732939		 Val RE1 dist: 1.1641774707370334
             SED dist: 0.5939580131979549		 Val SED dist: 2.3013504876030817


Epoch 6154/9000: Training Loss: 0.34950024473900887		 Val Loss: 1.596822526719835
             Training MAE: 0.05855265259742737		 Val MAE: 0.07013509422540665
             Algebraic dist: 0.5999195996452781		 Val Algebraic dist: 1.403429561191135
             RE1 dist: 0.3686259774600758		 Val RE1 dist: 1.5165856679280598
             SED dist: 0.669319751215916		 Val SED dist: 3.1581408182779946


Epoch 6155/9000: Training Loss: 0.4603758045271331		 Val Loss: 1.2146535449557834
             Training MAE: 0.06248743459582329		 Val MAE: 0.05764748156070709
             Algebraic dist: 0.7235681122424555		 Val Algebraic dist: 1.0262251959906683
             RE1 dist: 0.5129589006012562		 Val RE1 dist: 1.4081297980414496
             SED dist: 0.8887522080365349		 Val SED dist: 2.403437296549479


Epoch 6156/9000: Training Loss: 0.2691369337194106		 Val Loss: 3.02677239312066
             Training MAE: 0.05875144153833389		 Val MAE: 0.05213860049843788
             Algebraic dist: 0.48905641892377066		 Val Algebraic dist: 1.6593229505750868
             RE1 dist: 0.24253643260282629		 Val RE1 dist: 3.258145014444987
             SED dist: 0.506506414974437		 Val SED dist: 6.030282762315538


Epoch 6157/9000: Training Loss: 0.40254996804630055		 Val Loss: 1.260639296637641
             Training MAE: 0.05794980376958847		 Val MAE: 0.052926935255527496
             Algebraic dist: 0.6564176970837163		 Val Algebraic dist: 1.064247555202908
             RE1 dist: 0.4279642666087431		 Val RE1 dist: 1.4835394753350153
             SED dist: 0.7771206276089537		 Val SED dist: 2.497252994113498


Epoch 6158/9000: Training Loss: 0.29252100925819546		 Val Loss: 1.035989973280165
             Training MAE: 0.05926288291811943		 Val MAE: 0.0649266168475151
             Algebraic dist: 0.5257244858087278		 Val Algebraic dist: 0.9730549918280708
             RE1 dist: 0.27967507231469246		 Val RE1 dist: 1.1780402925279405
             SED dist: 0.5568876453474456		 Val SED dist: 2.04141722785102


Epoch 6159/9000: Training Loss: 0.28304479636398017		 Val Loss: 1.0545953114827473
             Training MAE: 0.058042995631694794		 Val MAE: 0.05173271894454956
             Algebraic dist: 0.5363256791058708		 Val Algebraic dist: 1.0983289082845051
             RE1 dist: 0.28891995373894186		 Val RE1 dist: 1.115639156765408
             SED dist: 0.5387392605052275		 Val SED dist: 2.085995144314236


Epoch 6160/9000: Training Loss: 0.39727723364736517		 Val Loss: 1.315029674106174
             Training MAE: 0.058799490332603455		 Val MAE: 0.053294405341148376
             Algebraic dist: 0.6526719635608149		 Val Algebraic dist: 1.0563085344102647
             RE1 dist: 0.42996855343089385		 Val RE1 dist: 1.4287887149386935
             SED dist: 0.7654905880198759		 Val SED dist: 2.605989244249132


Epoch 6161/9000: Training Loss: 0.3318774653416054		 Val Loss: 1.2300472259521484
             Training MAE: 0.05632970854640007		 Val MAE: 0.05195092782378197
             Algebraic dist: 0.5815406126134536		 Val Algebraic dist: 1.0363080766465929
             RE1 dist: 0.37116271374272364		 Val RE1 dist: 1.276096026102702
             SED dist: 0.6362505894081265		 Val SED dist: 2.4367889828152127


Epoch 6162/9000: Training Loss: 0.3808756435618681		 Val Loss: 2.2765640682644315
             Training MAE: 0.06383150070905685		 Val MAE: 0.05461903661489487
             Algebraic dist: 0.6248131172329772		 Val Algebraic dist: 1.5316253238254123
             RE1 dist: 0.39901961532293584		 Val RE1 dist: 3.1104558308919272
             SED dist: 0.7293121487486596		 Val SED dist: 4.528646257188585


Epoch 6163/9000: Training Loss: 0.3197401832131779		 Val Loss: 1.4411029815673828
             Training MAE: 0.056702520698308945		 Val MAE: 0.05613124743103981
             Algebraic dist: 0.5764171749937768		 Val Algebraic dist: 1.134878158569336
             RE1 dist: 0.34079547956878065		 Val RE1 dist: 1.7475252151489258
             SED dist: 0.61059476815018		 Val SED dist: 2.856692843967014


Epoch 6164/9000: Training Loss: 0.27161867478314566		 Val Loss: 1.4343767166137695
             Training MAE: 0.05830196291208267		 Val MAE: 0.05361512675881386
             Algebraic dist: 0.51635648690018		 Val Algebraic dist: 1.1505740483601887
             RE1 dist: 0.27390625897575827		 Val RE1 dist: 1.6896980073716905
             SED dist: 0.5147635515998391		 Val SED dist: 2.8446451822916665


Epoch 6165/9000: Training Loss: 0.24991587096569584		 Val Loss: 1.2708892822265625
             Training MAE: 0.05592145025730133		 Val MAE: 0.0530337393283844
             Algebraic dist: 0.4919432097790288		 Val Algebraic dist: 1.0052547454833984
             RE1 dist: 0.24147503048765892		 Val RE1 dist: 1.3880350324842665
             SED dist: 0.4734436857934092		 Val SED dist: 2.517888387044271


Epoch 6166/9000: Training Loss: 0.4118489658131319		 Val Loss: 2.2693792978922525
             Training MAE: 0.061639219522476196		 Val MAE: 0.06349199265241623
             Algebraic dist: 0.6545261308258655		 Val Algebraic dist: 1.4859028922186956
             RE1 dist: 0.4311717164282705		 Val RE1 dist: 3.0341794755723743
             SED dist: 0.7917302449544271		 Val SED dist: 4.5094176398383246


Epoch 6167/9000: Training Loss: 0.43567567713120403		 Val Loss: 2.3214492797851562
             Training MAE: 0.06015797331929207		 Val MAE: 0.05881651118397713
             Algebraic dist: 0.7167139988319546		 Val Algebraic dist: 1.6849452124701605
             RE1 dist: 0.5234031303256166		 Val RE1 dist: 3.318554984198676
             SED dist: 0.8397584802964154		 Val SED dist: 4.615954928927952


Epoch 6168/9000: Training Loss: 0.4089519276338465		 Val Loss: 1.328435156080458
             Training MAE: 0.06125175207853317		 Val MAE: 0.05847318843007088
             Algebraic dist: 0.6859701568005132		 Val Algebraic dist: 1.1192416085137262
             RE1 dist: 0.4753749697816138		 Val RE1 dist: 1.5541967815823026
             SED dist: 0.7849427765490962		 Val SED dist: 2.6304539574517145


Epoch 6169/9000: Training Loss: 0.28180847915948604		 Val Loss: 1.5736574596828885
             Training MAE: 0.06106878072023392		 Val MAE: 0.05842137336730957
             Algebraic dist: 0.5359658633961397		 Val Algebraic dist: 1.1022030512491863
             RE1 dist: 0.29616709316478057		 Val RE1 dist: 1.6061317655775282
             SED dist: 0.532935759600471		 Val SED dist: 3.1207527584499783


Epoch 6170/9000: Training Loss: 0.20514850990445005		 Val Loss: 1.5777336756388347
             Training MAE: 0.05579895153641701		 Val MAE: 0.051519837230443954
             Algebraic dist: 0.4245315626555798		 Val Algebraic dist: 1.1160537931654189
             RE1 dist: 0.1915445327758789		 Val RE1 dist: 1.5309918721516926
             SED dist: 0.38340288050034466		 Val SED dist: 3.132267846001519


Epoch 6171/9000: Training Loss: 0.28920944064271215		 Val Loss: 1.444057782491048
             Training MAE: 0.05647960305213928		 Val MAE: 0.052592940628528595
             Algebraic dist: 0.5273193658566943		 Val Algebraic dist: 1.07855044470893
             RE1 dist: 0.2846161150464825		 Val RE1 dist: 1.525938245985243
             SED dist: 0.5512046813964844		 Val SED dist: 2.8645057678222656


Epoch 6172/9000: Training Loss: 0.22944218504662608		 Val Loss: 0.8743340174357096
             Training MAE: 0.058042995631694794		 Val MAE: 0.059469178318977356
             Algebraic dist: 0.45271435905905333		 Val Algebraic dist: 0.9045806460910373
             RE1 dist: 0.21846556196025774		 Val RE1 dist: 0.8131749365064833
             SED dist: 0.42964232201669733		 Val SED dist: 1.7217515309651692


Epoch 6173/9000: Training Loss: 0.23143371881223193		 Val Loss: 1.0799197090996637
             Training MAE: 0.05610691383481026		 Val MAE: 0.05765214562416077
             Algebraic dist: 0.45134548112457873		 Val Algebraic dist: 0.9157310061984592
             RE1 dist: 0.20831497042786842		 Val RE1 dist: 1.0779891543918185
             SED dist: 0.43466826046214385		 Val SED dist: 2.133898629082574


Epoch 6174/9000: Training Loss: 0.4722153906728707		 Val Loss: 1.8095230526394315
             Training MAE: 0.05732642486691475		 Val MAE: 0.05469631031155586
             Algebraic dist: 0.7431578542671952		 Val Algebraic dist: 1.3627088334825304
             RE1 dist: 0.5296034719429764		 Val RE1 dist: 2.3436862097846136
             SED dist: 0.9161159290986902		 Val SED dist: 3.59427981906467


Epoch 6175/9000: Training Loss: 0.23914176342534085		 Val Loss: 1.0596077177259657
             Training MAE: 0.05957933887839317		 Val MAE: 0.05264539644122124
             Algebraic dist: 0.47301337298224955		 Val Algebraic dist: 0.9407932493421767
             RE1 dist: 0.2349673252479703		 Val RE1 dist: 1.0838567945692275
             SED dist: 0.448332618264591		 Val SED dist: 2.0955914391411676


Epoch 6176/9000: Training Loss: 0.24522053961660348		 Val Loss: 2.8002821604410806
             Training MAE: 0.05567479506134987		 Val MAE: 0.06755249947309494
             Algebraic dist: 0.46396225573969824		 Val Algebraic dist: 1.636121220058865
             RE1 dist: 0.22329549228443818		 Val RE1 dist: 3.239867740207248
             SED dist: 0.46390582065956265		 Val SED dist: 5.56744384765625


Epoch 6177/9000: Training Loss: 0.3910646251603669		 Val Loss: 1.2858212788899739
             Training MAE: 0.05740446597337723		 Val MAE: 0.05894368514418602
             Algebraic dist: 0.655670913995481		 Val Algebraic dist: 1.2043733596801758
             RE1 dist: 0.43648289699180454		 Val RE1 dist: 1.3859003914727106
             SED dist: 0.7553675034466911		 Val SED dist: 2.5451889038085938


Epoch 6178/9000: Training Loss: 0.27950380362716376		 Val Loss: 1.088646994696723
             Training MAE: 0.05778691545128822		 Val MAE: 0.05403171107172966
             Algebraic dist: 0.5426130107804841		 Val Algebraic dist: 0.9535676108466254
             RE1 dist: 0.29728201323864506		 Val RE1 dist: 1.1262361738416884
             SED dist: 0.531159569235409		 Val SED dist: 2.1528229183620877


Epoch 6179/9000: Training Loss: 0.31649424983005897		 Val Loss: 1.5653691821628146
             Training MAE: 0.05763768032193184		 Val MAE: 0.05168050900101662
             Algebraic dist: 0.569264804615694		 Val Algebraic dist: 1.176531261867947
             RE1 dist: 0.32318369547526044		 Val RE1 dist: 1.6667167875501845
             SED dist: 0.6051749809115541		 Val SED dist: 3.107681062486437


