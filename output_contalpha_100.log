/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/utils/generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
/home/alonkay/conda/alon/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/modeling_utils.py:479: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location=map_location)
/home/alonkay/Thesis/AffineRegressor.py:326: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location='cpu')
###########################################################################################################################################################

                         learning rate: 6e-05,  mlp_hidden_sizes: [1024, 512], batch_size: 32, norm: True, alpha: 100, avg embeddings: False, 
                        crop: 224 resize: 256, use conv: True pretrained: None, seed: 42, angle range: 30, shift range: 32, 
                        train length: 1024, val length: 320, test length: 320, get old path: False, embeddings to use: ['rotated_embeddings', 'original_embeddings'],
                        use_cls: False, frozen layer: 0


##### CONTINUE TRAINING #####


Epoch 391/500: Training Loss: 0.12868838012218475		 Val Loss: 0.11937053203582763
		Training MAE Angle: 0.03369705751538277		 Val MAE Angle: 0.03280672132968902
              Training MSE Angle: 0.0032444940879940987		 Val MSE Angle: 0.0029368575662374495
		Training MAE Shift: 0.023259077221155167		 Val MAE Shift: 0.022123950719833373
              Training Euclidean Shift: 0.03670056164264679	 Val Euclidean Shift: 0.03507101237773895


Epoch 392/500: Training Loss: 0.13863524794578552		 Val Loss: 0.16101572513580323
		Training MAE Angle: 0.03462320938706398		 Val MAE Angle: 0.03315967619419098
              Training MSE Angle: 0.002483620774000883		 Val MSE Angle: 0.003540743514895439
		Training MAE Shift: 0.025844398885965347		 Val MAE Shift: 0.025216180086135864
              Training Euclidean Shift: 0.040834940969944	 Val Euclidean Shift: 0.03969383537769318


Epoch 393/500: Training Loss: 0.12040901184082031		 Val Loss: 0.15973604917526246
		Training MAE Angle: 0.03342391550540924		 Val MAE Angle: 0.03523776531219482
              Training MSE Angle: 0.0023026259150356054		 Val MSE Angle: 0.002566705457866192
		Training MAE Shift: 0.02355049178004265		 Val MAE Shift: 0.024609144032001495
              Training Euclidean Shift: 0.03724128007888794	 Val Euclidean Shift: 0.038357877731323244


Epoch 394/500: Training Loss: 0.1354813128709793		 Val Loss: 0.12832534313201904
		Training MAE Angle: 0.03934047743678093		 Val MAE Angle: 0.030031043291091918
              Training MSE Angle: 0.0031206815037876368		 Val MSE Angle: 0.0020723972469568253
		Training MAE Shift: 0.025165067985653877		 Val MAE Shift: 0.024293236434459686
              Training Euclidean Shift: 0.039628446102142334	 Val Euclidean Shift: 0.03817054033279419


Epoch 395/500: Training Loss: 0.14891503751277924		 Val Loss: 0.4181992053985596
		Training MAE Angle: 0.036031078547239304		 Val MAE Angle: 0.10193520784378052
              Training MSE Angle: 0.0026163849979639053		 Val MSE Angle: 0.015733593702316286
		Training MAE Shift: 0.026465732604265213		 Val MAE Shift: 0.04699506759643555
              Training Euclidean Shift: 0.04205995425581932	 Val Euclidean Shift: 0.07326257824897767


Epoch 396/500: Training Loss: 0.11992676556110382		 Val Loss: 0.18708651065826415
		Training MAE Angle: 0.033713631331920624		 Val MAE Angle: 0.03889152109622955
              Training MSE Angle: 0.00212376331910491		 Val MSE Angle: 0.0063127391040325165
		Training MAE Shift: 0.02469799667596817		 Val MAE Shift: 0.023038947582244874
              Training Euclidean Shift: 0.038590870797634125	 Val Euclidean Shift: 0.036542651057243344


Epoch 397/500: Training Loss: 0.09282506257295609		 Val Loss: 0.14973920583724976
		Training MAE Angle: 0.028376799076795578		 Val MAE Angle: 0.0378037691116333
              Training MSE Angle: 0.0016384429764002562		 Val MSE Angle: 0.0025184500962495806
		Training MAE Shift: 0.0206568855792284		 Val MAE Shift: 0.02783365547657013
              Training Euclidean Shift: 0.032705359160900116	 Val Euclidean Shift: 0.04325530230998993


Epoch 398/500: Training Loss: 0.2757309079170227		 Val Loss: 0.3597561359405518
		Training MAE Angle: 0.04902570694684982		 Val MAE Angle: 0.060277271270751956
              Training MSE Angle: 0.006664752960205078		 Val MSE Angle: 0.007163216918706894
		Training MAE Shift: 0.03426378592848778		 Val MAE Shift: 0.04019830822944641
              Training Euclidean Shift: 0.05379478260874748	 Val Euclidean Shift: 0.0644866943359375


Epoch 399/500: Training Loss: 0.3205479383468628		 Val Loss: 0.43485398292541505
		Training MAE Angle: 0.05262523889541626		 Val MAE Angle: 0.053748345375061034
              Training MSE Angle: 0.007286485750228167		 Val MSE Angle: 0.006338150799274444
		Training MAE Shift: 0.038814790546894073		 Val MAE Shift: 0.042353302240371704
              Training Euclidean Shift: 0.061279281973838806	 Val Euclidean Shift: 0.06665337085723877


Epoch 400/500: Training Loss: 0.23891213536262512		 Val Loss: 0.32021901607513426
		Training MAE Angle: 0.04171668365597725		 Val MAE Angle: 0.04260750412940979
              Training MSE Angle: 0.0034123859368264675		 Val MSE Angle: 0.00657874196767807
		Training MAE Shift: 0.03417833894491196		 Val MAE Shift: 0.035788795351982115
              Training Euclidean Shift: 0.05414649099111557	 Val Euclidean Shift: 0.05726172924041748


Epoch 401/500: Training Loss: 0.29661330580711365		 Val Loss: 0.3887065649032593
		Training MAE Angle: 0.048102185130119324		 Val MAE Angle: 0.05569719672203064
              Training MSE Angle: 0.004581871908158064		 Val MSE Angle: 0.005682564154267311
		Training MAE Shift: 0.03516018018126488		 Val MAE Shift: 0.038870975375175476
              Training Euclidean Shift: 0.05552748590707779	 Val Euclidean Shift: 0.061646461486816406


Epoch 402/500: Training Loss: 0.18601182103157043		 Val Loss: 0.18590883016586304
		Training MAE Angle: 0.038734320551157		 Val MAE Angle: 0.0350434809923172
              Training MSE Angle: 0.0031207206193357706		 Val MSE Angle: 0.0029524749144911764
		Training MAE Shift: 0.030045732855796814		 Val MAE Shift: 0.02991197109222412
              Training Euclidean Shift: 0.04737158119678497	 Val Euclidean Shift: 0.04703030288219452


Epoch 403/500: Training Loss: 0.1435166895389557		 Val Loss: 0.3668407678604126
		Training MAE Angle: 0.03370159864425659		 Val MAE Angle: 0.033009618520736694
              Training MSE Angle: 0.002375012030825019		 Val MSE Angle: 0.0028995878994464873
		Training MAE Shift: 0.026712220162153244		 Val MAE Shift: 0.027232128381729125
              Training Euclidean Shift: 0.04224153608083725	 Val Euclidean Shift: 0.043736255168914794


Epoch 404/500: Training Loss: 0.1087353527545929		 Val Loss: 0.11349185705184936
		Training MAE Angle: 0.0307347159832716		 Val MAE Angle: 0.02903020679950714
              Training MSE Angle: 0.0023600340355187654		 Val MSE Angle: 0.0022549811750650407
		Training MAE Shift: 0.022424466907978058		 Val MAE Shift: 0.022809046506881713
              Training Euclidean Shift: 0.035403069108724594	 Val Euclidean Shift: 0.03636438250541687


Epoch 405/500: Training Loss: 0.1303711235523224		 Val Loss: 0.21685607433319093
		Training MAE Angle: 0.030338436365127563		 Val MAE Angle: 0.050670504570007324
              Training MSE Angle: 0.0018976827850565314		 Val MSE Angle: 0.005984265729784966
		Training MAE Shift: 0.023808803409337997		 Val MAE Shift: 0.032571223378181455
              Training Euclidean Shift: 0.03762650117278099	 Val Euclidean Shift: 0.051703262329101565


### Not decreasing ###

Epoch 406/500: Training Loss: 0.1333448588848114		 Val Loss: 0.1572378993034363
		Training MAE Angle: 0.03401520848274231		 Val MAE Angle: 0.03288297057151794
              Training MSE Angle: 0.002668579574674368		 Val MSE Angle: 0.0023787502199411393
		Training MAE Shift: 0.023570915684103966		 Val MAE Shift: 0.02875393033027649
              Training Euclidean Shift: 0.03735363483428955	 Val Euclidean Shift: 0.044887059926986696


Epoch 407/500: Training Loss: 0.10510561615228653		 Val Loss: 0.1323723554611206
		Training MAE Angle: 0.03203624114394188		 Val MAE Angle: 0.03042120039463043
              Training MSE Angle: 0.002214594976976514		 Val MSE Angle: 0.0016966234892606736
		Training MAE Shift: 0.02252952754497528		 Val MAE Shift: 0.025113978981971742
              Training Euclidean Shift: 0.03553684055805206	 Val Euclidean Shift: 0.03986727893352508


Epoch 408/500: Training Loss: 0.12866410613059998		 Val Loss: 0.16533102989196777
		Training MAE Angle: 0.036865249276161194		 Val MAE Angle: 0.034763389825820924
              Training MSE Angle: 0.004963489715009928		 Val MSE Angle: 0.001997913792729378
		Training MAE Shift: 0.024403879418969154		 Val MAE Shift: 0.029302293062210084
              Training Euclidean Shift: 0.03843483328819275	 Val Euclidean Shift: 0.04553753435611725


Epoch 409/500: Training Loss: 0.1376975178718567		 Val Loss: 0.19190354347229005
		Training MAE Angle: 0.032561663538217545		 Val MAE Angle: 0.03354470431804657
              Training MSE Angle: 0.0024436027742922306		 Val MSE Angle: 0.0022864745929837226
		Training MAE Shift: 0.024497855454683304		 Val MAE Shift: 0.02784256935119629
              Training Euclidean Shift: 0.038796596229076385	 Val Euclidean Shift: 0.04408673048019409


Epoch 410/500: Training Loss: 0.1724843978881836		 Val Loss: 0.13392456769943237
		Training MAE Angle: 0.03545297682285309		 Val MAE Angle: 0.04084605872631073
              Training MSE Angle: 0.0028512084390968084		 Val MSE Angle: 0.0033851731568574905
		Training MAE Shift: 0.02680676057934761		 Val MAE Shift: 0.02414836883544922
              Training Euclidean Shift: 0.042195916175842285	 Val Euclidean Shift: 0.038363215327262876


Epoch 411/500: Training Loss: 0.09951911866664886		 Val Loss: 0.10209269523620605
		Training MAE Angle: 0.03155143931508064		 Val MAE Angle: 0.035467174649238584
              Training MSE Angle: 0.001981420675292611		 Val MSE Angle: 0.003018062375485897
		Training MAE Shift: 0.021927978843450546		 Val MAE Shift: 0.02084934860467911
              Training Euclidean Shift: 0.03469815105199814	 Val Euclidean Shift: 0.03256444036960602


Epoch 412/500: Training Loss: 0.07520892471075058		 Val Loss: 0.10576055049896241
		Training MAE Angle: 0.027447376400232315		 Val MAE Angle: 0.030591264367103577
              Training MSE Angle: 0.0019046401139348745		 Val MSE Angle: 0.0019362477585673332
		Training MAE Shift: 0.019320139661431313		 Val MAE Shift: 0.022101837396621703
              Training Euclidean Shift: 0.030334118753671646	 Val Euclidean Shift: 0.034629815816879274


Epoch 413/500: Training Loss: 0.08243031054735184		 Val Loss: 0.06768858432769775
		Training MAE Angle: 0.028808824717998505		 Val MAE Angle: 0.027197235822677614
              Training MSE Angle: 0.002190929837524891		 Val MSE Angle: 0.0014641491696238517
		Training MAE Shift: 0.018977683037519455		 Val MAE Shift: 0.018210913240909576
              Training Euclidean Shift: 0.030208341777324677	 Val Euclidean Shift: 0.029022279381752013


### Not decreasing ###

## TEST RESULTS: ##
Test Loss: 0.24535878002643585 
Test Euclidean Shift: 0.039625383913517		 Test MAE Shift: 0.025002237409353256
Test MAE Angle: 0.03689492493867874		 Test MSE Angle: 0.005148579366505146


