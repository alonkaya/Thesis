nohup: ignoring input
/home/aviran/miniconda3/envs/alon_env/lib/python3.9/site-packages/transformers/utils/generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
/home/aviran/miniconda3/envs/alon_env/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/aviran/miniconda3/envs/alon_env/lib/python3.9/site-packages/transformers/modeling_utils.py:479: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location=map_location)
###########################################################################################################################################################

                         learning rate: 6e-05,  mlp_hidden_sizes: [1024, 512], batch_size: 32, norm: True, alpha: 1, avg embeddings: False, 
                        crop: 224 resize: 256, use conv: True pretrained: None, seed: 42, angle range: 90, shift range: 0, 
                        train length: 6144, val length: 780, test length: 780, get old path: False



Epoch 1/50: Training Loss: 0.24973650773366293		 Val Loss: 0.058352265357971195

Training MAE Angle: 0.412243127822876		 Val MAE Angle: 0.18198299407958984
Training MSE Angle: 0.24973650773366293		 Val MSE Angle: 0.058352265357971195




Epoch 2/50: Training Loss: 0.02810401717821757		 Val Loss: 0.019593780040740968

Training MAE Angle: 0.12267563740412395		 Val MAE Angle: 0.10331418037414551
Training MSE Angle: 0.02810401717821757		 Val MSE Angle: 0.019593780040740968




Epoch 3/50: Training Loss: 0.011983120193084082		 Val Loss: 0.00632219672203064

Training MAE Angle: 0.07729425032933553		 Val MAE Angle: 0.05560895919799805
Training MSE Angle: 0.011983120193084082		 Val MSE Angle: 0.00632219672203064




Epoch 4/50: Training Loss: 0.006952201947569847		 Val Loss: 0.008161522746086121

Training MAE Angle: 0.058092713356018066		 Val MAE Angle: 0.059768176078796385
Training MSE Angle: 0.006952201947569847		 Val MSE Angle: 0.008161522746086121




Epoch 5/50: Training Loss: 0.0065500059475501375		 Val Loss: 0.0035000273585319517

Training MAE Angle: 0.0554213672876358		 Val MAE Angle: 0.04204580307006836
Training MSE Angle: 0.0065500059475501375		 Val MSE Angle: 0.0035000273585319517




Epoch 6/50: Training Loss: 0.004963891891141732		 Val Loss: 0.004756055474281311

Training MAE Angle: 0.047744755943616234		 Val MAE Angle: 0.040991716384887696
Training MSE Angle: 0.004963891891141732		 Val MSE Angle: 0.004756055474281311




Epoch 7/50: Training Loss: 0.004143962326149146		 Val Loss: 0.003568207919597626

Training MAE Angle: 0.04501215120156606		 Val MAE Angle: 0.04030585289001465
Training MSE Angle: 0.004143962326149146		 Val MSE Angle: 0.003568207919597626




Epoch 8/50: Training Loss: 0.00335705808053414		 Val Loss: 0.003575730621814728

Training MAE Angle: 0.039937992890675865		 Val MAE Angle: 0.03720128536224365
Training MSE Angle: 0.00335705808053414		 Val MSE Angle: 0.003575730621814728




Epoch 9/50: Training Loss: 0.003932768789430459		 Val Loss: 0.006764553189277649

Training MAE Angle: 0.04256589710712433		 Val MAE Angle: 0.05892587661743164
Training MSE Angle: 0.003932768789430459		 Val MSE Angle: 0.006764553189277649




Epoch 10/50: Training Loss: 0.0035407611479361853		 Val Loss: 0.002723037302494049

Training MAE Angle: 0.041485495865345		 Val MAE Angle: 0.036393487453460695
Training MSE Angle: 0.0035407611479361853		 Val MSE Angle: 0.002723037302494049




Epoch 11/50: Training Loss: 0.0031867260113358498		 Val Loss: 0.003028717041015625

Training MAE Angle: 0.03898567954699198		 Val MAE Angle: 0.04134418487548828
Training MSE Angle: 0.0031867260113358498		 Val MSE Angle: 0.003028717041015625




Epoch 12/50: Training Loss: 0.002388753928244114		 Val Loss: 0.0015359185636043549

Training MAE Angle: 0.03505793710549673		 Val MAE Angle: 0.02786506175994873
Training MSE Angle: 0.002388753928244114		 Val MSE Angle: 0.0015359185636043549




Epoch 13/50: Training Loss: 0.003541780635714531		 Val Loss: 0.003296824395656586

Training MAE Angle: 0.038397779067357383		 Val MAE Angle: 0.03986901998519898
Training MSE Angle: 0.003541780635714531		 Val MSE Angle: 0.003296824395656586




Epoch 14/50: Training Loss: 0.0031807549918691316		 Val Loss: 0.002331922799348831

Training MAE Angle: 0.03948031862576803		 Val MAE Angle: 0.033849148750305175
Training MSE Angle: 0.0031807549918691316		 Val MSE Angle: 0.002331922799348831




Epoch 15/50: Training Loss: 0.0023598105957110724		 Val Loss: 0.001911144256591797

Training MAE Angle: 0.034076946477095284		 Val MAE Angle: 0.03229484796524048
Training MSE Angle: 0.0023598105957110724		 Val MSE Angle: 0.001911144256591797




Epoch 16/50: Training Loss: 0.0018238849006593227		 Val Loss: 0.0012511585652828217

Training MAE Angle: 0.030363375941912334		 Val MAE Angle: 0.02499173641204834
Training MSE Angle: 0.0018238849006593227		 Val MSE Angle: 0.0012511585652828217




Epoch 17/50: Training Loss: 0.0019398117437958717		 Val Loss: 0.0017756316065788268

Training MAE Angle: 0.03105748196442922		 Val MAE Angle: 0.0283506178855896
Training MSE Angle: 0.0019398117437958717		 Val MSE Angle: 0.0017756316065788268




Epoch 18/50: Training Loss: 0.0024491663401325545		 Val Loss: 0.0030404120683670045

Training MAE Angle: 0.03454777350028356		 Val MAE Angle: 0.043148012161254884
Training MSE Angle: 0.0024491663401325545		 Val MSE Angle: 0.0030404120683670045




Epoch 19/50: Training Loss: 0.0018471617562075455		 Val Loss: 0.0018273910880088806

Training MAE Angle: 0.03046466161807378		 Val MAE Angle: 0.03001237869262695
Training MSE Angle: 0.0018471617562075455		 Val MSE Angle: 0.0018273910880088806




Epoch 20/50: Training Loss: 0.0016203091169397037		 Val Loss: 0.0010799449682235718

Training MAE Angle: 0.028721146285533905		 Val MAE Angle: 0.02287912130355835
Training MSE Angle: 0.0016203091169397037		 Val MSE Angle: 0.0010799449682235718




Epoch 21/50: Training Loss: 0.0019205599091947079		 Val Loss: 0.0015104156732559204

Training MAE Angle: 0.0312923068801562		 Val MAE Angle: 0.026508219242095947
Training MSE Angle: 0.0019205599091947079		 Val MSE Angle: 0.0015104156732559204




Epoch 22/50: Training Loss: 0.002093482452134291		 Val Loss: 0.0017412719130516052

Training MAE Angle: 0.03275461743275324		 Val MAE Angle: 0.03121621608734131
Training MSE Angle: 0.002093482452134291		 Val MSE Angle: 0.0017412719130516052




Epoch 23/50: Training Loss: 0.001899763010442257		 Val Loss: 0.00136642262339592

Training MAE Angle: 0.03076959401369095		 Val MAE Angle: 0.027462022304534914
Training MSE Angle: 0.001899763010442257		 Val MSE Angle: 0.00136642262339592




Epoch 24/50: Training Loss: 0.0025491820027430854		 Val Loss: 0.004637700319290161

Training MAE Angle: 0.03273076812426249		 Val MAE Angle: 0.05071243286132812
Training MSE Angle: 0.0025491820027430854		 Val MSE Angle: 0.004637700319290161




Epoch 25/50: Training Loss: 0.004337677421669166		 Val Loss: 0.001543009877204895

Training MAE Angle: 0.04380263388156891		 Val MAE Angle: 0.027471177577972412
Training MSE Angle: 0.004337677421669166		 Val MSE Angle: 0.001543009877204895




Epoch 26/50: Training Loss: 0.002058333562066158		 Val Loss: 0.0019755347073078158

Training MAE Angle: 0.03132546444733938		 Val MAE Angle: 0.03060513734817505
Training MSE Angle: 0.002058333562066158		 Val MSE Angle: 0.0019755347073078158




Epoch 27/50: Training Loss: 0.00367535836994648		 Val Loss: 0.004507937729358673

Training MAE Angle: 0.038215103248755135		 Val MAE Angle: 0.039123063087463376
Training MSE Angle: 0.00367535836994648		 Val MSE Angle: 0.004507937729358673




Epoch 28/50: Training Loss: 0.0019142342110474904		 Val Loss: 0.0010976278036832808

Training MAE Angle: 0.030249786873658497		 Val MAE Angle: 0.02448277235031128
Training MSE Angle: 0.0019142342110474904		 Val MSE Angle: 0.0010976278036832808




Epoch 29/50: Training Loss: 0.0024066376499831676		 Val Loss: 0.001730254590511322

Training MAE Angle: 0.032863872746626534		 Val MAE Angle: 0.031075758934020994
Training MSE Angle: 0.0024066376499831676		 Val MSE Angle: 0.001730254590511322




Epoch 30/50: Training Loss: 0.0026983429367343583		 Val Loss: 0.0020176002383232115

Training MAE Angle: 0.033357578019301094		 Val MAE Angle: 0.031069250106811525
Training MSE Angle: 0.0026983429367343583		 Val MSE Angle: 0.0020176002383232115




Epoch 31/50: Training Loss: 0.0016626242237786453		 Val Loss: 0.0009322605282068253

Training MAE Angle: 0.028628294666608173		 Val MAE Angle: 0.02278876066207886
Training MSE Angle: 0.0016626242237786453		 Val MSE Angle: 0.0009322605282068253




Epoch 32/50: Training Loss: 0.0011103573876122634		 Val Loss: 0.0013433335721492767

Training MAE Angle: 0.023934848606586456		 Val MAE Angle: 0.021954090595245362
Training MSE Angle: 0.0011103573876122634		 Val MSE Angle: 0.0013433335721492767




Epoch 33/50: Training Loss: 0.0012565703752140205		 Val Loss: 0.0016797074675559997

Training MAE Angle: 0.023812358578046162		 Val MAE Angle: 0.028462910652160646
Training MSE Angle: 0.0012565703752140205		 Val MSE Angle: 0.0016797074675559997




Epoch 34/50: Training Loss: 0.0019449759274721146		 Val Loss: 0.0010833823680877685

Training MAE Angle: 0.03065866728623708		 Val MAE Angle: 0.02470611572265625
Training MSE Angle: 0.0019449759274721146		 Val MSE Angle: 0.0010833823680877685




Epoch 35/50: Training Loss: 0.0011784020656098921		 Val Loss: 0.0008224028348922729

Training MAE Angle: 0.024950993557771046		 Val MAE Angle: 0.02115251064300537
Training MSE Angle: 0.0011784020656098921		 Val MSE Angle: 0.0008224028348922729




Epoch 36/50: Training Loss: 0.0009169235515097777		 Val Loss: 0.0009048888832330704

Training MAE Angle: 0.022323615849018097		 Val MAE Angle: 0.023310976028442384
Training MSE Angle: 0.0009169235515097777		 Val MSE Angle: 0.0009048888832330704




Epoch 37/50: Training Loss: 0.0009519097705682119		 Val Loss: 0.001035831943154335

Training MAE Angle: 0.02243071049451828		 Val MAE Angle: 0.021921699047088624
Training MSE Angle: 0.0009519097705682119		 Val MSE Angle: 0.001035831943154335




Epoch 38/50: Training Loss: 0.0020001094477872052		 Val Loss: 0.0014103268086910247

Training MAE Angle: 0.02975102762381236		 Val MAE Angle: 0.026382229328155517
Training MSE Angle: 0.0020001094477872052		 Val MSE Angle: 0.0014103268086910247




Epoch 39/50: Training Loss: 0.0014613973908126354		 Val Loss: 0.0008795829117298126

Training MAE Angle: 0.0268388365705808		 Val MAE Angle: 0.022128412723541258
Training MSE Angle: 0.0014613973908126354		 Val MSE Angle: 0.0008795829117298126




Epoch 40/50: Training Loss: 0.0010873229863742988		 Val Loss: 0.0006720879673957824

Training MAE Angle: 0.02332768092552821		 Val MAE Angle: 0.018216872215270997
Training MSE Angle: 0.0010873229863742988		 Val MSE Angle: 0.0006720879673957824




Epoch 41/50: Training Loss: 0.0007640660429994265		 Val Loss: 0.001180099993944168

Training MAE Angle: 0.02004878968000412		 Val MAE Angle: 0.021258795261383058
Training MSE Angle: 0.0007640660429994265		 Val MSE Angle: 0.001180099993944168




Epoch 42/50: Training Loss: 0.0006958394466588894		 Val Loss: 0.0005226946622133255

Training MAE Angle: 0.019513022154569626		 Val MAE Angle: 0.016763339042663573
Training MSE Angle: 0.0006958394466588894		 Val MSE Angle: 0.0005226946622133255




Epoch 43/50: Training Loss: 0.0009116145471731821		 Val Loss: 0.0008805253356695175

Training MAE Angle: 0.021748113135496776		 Val MAE Angle: 0.021581671237945556
Training MSE Angle: 0.0009116145471731821		 Val MSE Angle: 0.0008805253356695175




Epoch 44/50: Training Loss: 0.0009766089885185163		 Val Loss: 0.0006729286164045334

Training MAE Angle: 0.022426774104436237		 Val MAE Angle: 0.01892619490623474
Training MSE Angle: 0.0009766089885185163		 Val MSE Angle: 0.0006729286164045334




Epoch 45/50: Training Loss: 0.0008573333422342936		 Val Loss: 0.0006773998588323594

Training MAE Angle: 0.020812435696522396		 Val MAE Angle: 0.018972095251083374
Training MSE Angle: 0.0008573333422342936		 Val MSE Angle: 0.0006773998588323594




Epoch 46/50: Training Loss: 0.002060715729991595		 Val Loss: 0.0012111949920654297

Training MAE Angle: 0.031755524377028145		 Val MAE Angle: 0.026367075443267822
Training MSE Angle: 0.002060715729991595		 Val MSE Angle: 0.0012111949920654297




Epoch 47/50: Training Loss: 0.0059725139290094376		 Val Loss: 0.006890559792518616

Training MAE Angle: 0.04102780173222224		 Val MAE Angle: 0.0625872802734375
Training MSE Angle: 0.0059725139290094376		 Val MSE Angle: 0.006890559792518616




Epoch 48/50: Training Loss: 0.00337299487243096		 Val Loss: 0.00102901354432106

Training MAE Angle: 0.03786569833755493		 Val MAE Angle: 0.02349658727645874
Training MSE Angle: 0.00337299487243096		 Val MSE Angle: 0.00102901354432106




Epoch 49/50: Training Loss: 0.0012230159093936284		 Val Loss: 0.0012502902746200561

Training MAE Angle: 0.024773776531219482		 Val MAE Angle: 0.0212955117225647
Training MSE Angle: 0.0012230159093936284		 Val MSE Angle: 0.0012502902746200561




Epoch 50/50: Training Loss: 0.0008898781767735878		 Val Loss: 0.0005228331312537194

Training MAE Angle: 0.021106605728467304		 Val MAE Angle: 0.01692760944366455
Training MSE Angle: 0.0008898781767735878		 Val MSE Angle: 0.0005228331312537194




## TEST RESULTS: ##
Test Loss: 0.0006447519990615547 
Test MAE Shift: 0.0		 Test Euclidean Shift: 0.0
Test MAE Angle: 0.018252220004796982		 Test MSE Angle: 0.0006447519990615547


