nohup: ignoring input
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/utils/generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
/home/alonkay/conda/alon/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/modeling_utils.py:479: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location=map_location)
/home/alonkay/Thesis/AffineRegressor.py:338: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location='cpu')
Model plots/Affine/BS_32__lr_6e-05__alpha_10__conv__original_rotated_angle_30__shift_32/CLIP_16/size_4048__frozen_0 already trained
Model plots/Affine/BS_32__lr_6e-05__alpha_10__conv__original_rotated_angle_30__shift_32/CLIP_16/size_1048__frozen_0 already trained

###########################################################################################################################################################

                         learning rate: 6e-05,  mlp_hidden_sizes: [1024, 512], batch_size: 4, norm: True, alpha: 10, avg embeddings: False, 
                        crop: 224 resize: 256, use conv: True pretrained: None, seed: 42, angle range: 30, shift range: 32, 
                        train length: 256, val length: 320, test length: 320, get old path: False, embeddings to use: ['rotated_embeddings', 'original_embeddings'],
                        use_cls: False, frozen layer: 0


Epoch 1/1000: Training Loss: 3.7056944370269775		 Val Loss: 3.1680282592773437
		Training MAE Angle: 0.494571328163147		 Val MAE Angle: 0.47186622619628904
              Training MSE Angle: 0.3281060457229614		 Val MSE Angle: 0.3046887874603271
		Training MAE Shift: 0.5018086433410645		 Val MAE Shift: 0.4584378719329834
              Training Euclidean Shift: 0.7688234448432922	 Val Euclidean Shift: 0.7050290107727051


Epoch 2/1000: Training Loss: 2.123927593231201		 Val Loss: 0.760580587387085
		Training MAE Angle: 0.4976749122142792		 Val MAE Angle: 0.5174380302429199
              Training MSE Angle: 0.3305557072162628		 Val MSE Angle: 0.34418697357177735
		Training MAE Shift: 0.3436613082885742		 Val MAE Shift: 0.15976552963256835
              Training Euclidean Shift: 0.5303611159324646	 Val Euclidean Shift: 0.2512360572814941


Epoch 3/1000: Training Loss: 0.815807044506073		 Val Loss: 0.6326952457427979
		Training MAE Angle: 0.47891971468925476		 Val MAE Angle: 0.48116216659545896
              Training MSE Angle: 0.319359689950943		 Val MSE Angle: 0.3177292823791504
		Training MAE Shift: 0.17052136361598969		 Val MAE Shift: 0.13583590984344482
              Training Euclidean Shift: 0.26597681641578674	 Val Euclidean Shift: 0.21480748653411866


Epoch 4/1000: Training Loss: 0.6510441303253174		 Val Loss: 0.5773891925811767
		Training MAE Angle: 0.45513156056404114		 Val MAE Angle: 0.47940263748168943
              Training MSE Angle: 0.2996463179588318		 Val MSE Angle: 0.30798256397247314
		Training MAE Shift: 0.13755573332309723		 Val MAE Shift: 0.12366650104522706
              Training Euclidean Shift: 0.21387110650539398	 Val Euclidean Shift: 0.1966681718826294


Epoch 5/1000: Training Loss: 0.512186586856842		 Val Loss: 0.5437566757202148
		Training MAE Angle: 0.4439839720726013		 Val MAE Angle: 0.4572876453399658
              Training MSE Angle: 0.27392446994781494		 Val MSE Angle: 0.2802198171615601
		Training MAE Shift: 0.12051407247781754		 Val MAE Shift: 0.1263706922531128
              Training Euclidean Shift: 0.18778516352176666	 Val Euclidean Shift: 0.19885711669921874


Epoch 6/1000: Training Loss: 0.5582170486450195		 Val Loss: 2.78842716217041
		Training MAE Angle: 0.459994375705719		 Val MAE Angle: 0.4650111198425293
              Training MSE Angle: 0.28868556022644043		 Val MSE Angle: 0.299500846862793
		Training MAE Shift: 0.1198573186993599		 Val MAE Shift: 0.41504735946655275
              Training Euclidean Shift: 0.18778668344020844	 Val Euclidean Shift: 0.6434542179107666


Epoch 7/1000: Training Loss: 0.6390587687492371		 Val Loss: 0.37729926109313966
		Training MAE Angle: 0.3667450249195099		 Val MAE Angle: 0.3337472200393677
              Training MSE Angle: 0.2039661407470703		 Val MSE Angle: 0.1599040985107422
		Training MAE Shift: 0.15933360159397125		 Val MAE Shift: 0.10736143589019775
              Training Euclidean Shift: 0.2474106252193451	 Val Euclidean Shift: 0.1696377158164978


Epoch 8/1000: Training Loss: 0.3641788959503174		 Val Loss: 0.5264490127563477
		Training MAE Angle: 0.2619960606098175		 Val MAE Angle: 0.2191014051437378
              Training MSE Angle: 0.11593487113714218		 Val MSE Angle: 0.08389322757720948
		Training MAE Shift: 0.12074350565671921		 Val MAE Shift: 0.1558559775352478
              Training Euclidean Shift: 0.19001780450344086	 Val Euclidean Shift: 0.2475491762161255


Epoch 9/1000: Training Loss: 0.3188074231147766		 Val Loss: 0.5483219146728515
		Training MAE Angle: 0.19978833198547363		 Val MAE Angle: 0.23891816139221192
              Training MSE Angle: 0.06671323627233505		 Val MSE Angle: 0.08738794326782226
		Training MAE Shift: 0.12196474522352219		 Val MAE Shift: 0.176779305934906
              Training Euclidean Shift: 0.19182878732681274	 Val Euclidean Shift: 0.2766855001449585


Epoch 10/1000: Training Loss: 0.22531239688396454		 Val Loss: 0.2372828722000122
		Training MAE Angle: 0.17752259969711304		 Val MAE Angle: 0.20079176425933837
              Training MSE Angle: 0.0511343888938427		 Val MSE Angle: 0.06343351602554322
		Training MAE Shift: 0.10047124326229095		 Val MAE Shift: 0.1008310317993164
              Training Euclidean Shift: 0.15693563222885132	 Val Euclidean Shift: 0.15815049409866333


Epoch 11/1000: Training Loss: 0.21050995588302612		 Val Loss: 0.2422929048538208
		Training MAE Angle: 0.18559323251247406		 Val MAE Angle: 0.16671991348266602
              Training MSE Angle: 0.06018705293536186		 Val MSE Angle: 0.04681379199028015
		Training MAE Shift: 0.09537019580602646		 Val MAE Shift: 0.10610861778259277
              Training Euclidean Shift: 0.15012846887111664	 Val Euclidean Shift: 0.16655635833740234


Epoch 12/1000: Training Loss: 0.23986896872520447		 Val Loss: 0.2128316879272461
		Training MAE Angle: 0.18461857736110687		 Val MAE Angle: 0.15879114866256713
              Training MSE Angle: 0.05933469533920288		 Val MSE Angle: 0.04336226284503937
		Training MAE Shift: 0.10333757847547531		 Val MAE Shift: 0.09756572246551513
              Training Euclidean Shift: 0.16286703944206238	 Val Euclidean Shift: 0.15262504816055297


Epoch 13/1000: Training Loss: 0.47956109046936035		 Val Loss: 0.33185834884643556
		Training MAE Angle: 0.22919364273548126		 Val MAE Angle: 0.21391911506652833
              Training MSE Angle: 0.09164563566446304		 Val MSE Angle: 0.0699435293674469
		Training MAE Shift: 0.14271177351474762		 Val MAE Shift: 0.12228899002075196
              Training Euclidean Shift: 0.2239200621843338	 Val Euclidean Shift: 0.1948959469795227


Epoch 14/1000: Training Loss: 0.2661600410938263		 Val Loss: 0.2770257472991943
		Training MAE Angle: 0.18477755784988403		 Val MAE Angle: 0.18506209850311278
              Training MSE Angle: 0.05516832321882248		 Val MSE Angle: 0.06492359042167664
		Training MAE Shift: 0.11232984811067581		 Val MAE Shift: 0.11137031316757202
              Training Euclidean Shift: 0.17622388899326324	 Val Euclidean Shift: 0.17763402462005615


Epoch 15/1000: Training Loss: 0.16645531356334686		 Val Loss: 0.2357481002807617
		Training MAE Angle: 0.17003434896469116		 Val MAE Angle: 0.20947611331939697
              Training MSE Angle: 0.04614292085170746		 Val MSE Angle: 0.06976005434989929
		Training MAE Shift: 0.0834156796336174		 Val MAE Shift: 0.0971461296081543
              Training Euclidean Shift: 0.13232234120368958	 Val Euclidean Shift: 0.15120357275009155


Epoch 16/1000: Training Loss: 0.22820143401622772		 Val Loss: 0.16293025016784668
		Training MAE Angle: 0.17464013397693634		 Val MAE Angle: 0.1680671453475952
              Training MSE Angle: 0.05027109012007713		 Val MSE Angle: 0.04494514167308807
		Training MAE Shift: 0.09871961176395416		 Val MAE Shift: 0.08206983208656311
              Training Euclidean Shift: 0.15671846270561218	 Val Euclidean Shift: 0.12865545749664306


Epoch 17/1000: Training Loss: 0.19401390850543976		 Val Loss: 0.17805546522140503
		Training MAE Angle: 0.1463070511817932		 Val MAE Angle: 0.16470006704330445
              Training MSE Angle: 0.0357627272605896		 Val MSE Angle: 0.04883269965648651
