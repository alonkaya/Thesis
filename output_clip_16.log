nohup: ignoring input
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/utils/generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
/home/alonkay/conda/alon/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/modeling_utils.py:479: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location=map_location)
/home/alonkay/Thesis/AffineRegressor.py:328: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(model_path, map_location='cpu')
Model plots/Affine/BS_32__lr_6e-05__alpha_10__conv__original_rotated_angle_30__shift_32/CLIP_16/size_4048__frozen_0 already trained
Model plots/Affine/BS_32__lr_6e-05__alpha_10__conv__original_rotated_angle_30__shift_32/CLIP_16/size_1048__frozen_0 already trained

###########################################################################################################################################################

                         learning rate: 6e-05,  mlp_hidden_sizes: [1024, 512], batch_size: 32, norm: True, alpha: 10, avg embeddings: False, 
                        crop: 224 resize: 256, use conv: True pretrained: None, seed: 42, angle range: 30, shift range: 32, 
                        train length: 256, val length: 320, test length: 320, get old path: False, embeddings to use: ['rotated_embeddings', 'original_embeddings'],
                        use_cls: False, frozen layer: 0


##### CONTINUE TRAINING #####


Epoch 529/1200: Training Loss: 0.02920052967965603		 Val Loss: 0.03297947645187378
		Training MAE Angle: 0.0474843755364418		 Val MAE Angle: 0.042091783881187436
              Training MSE Angle: 0.004840997513383627		 Val MSE Angle: 0.0038871727883815765
		Training MAE Shift: 0.03470669686794281		 Val MAE Shift: 0.03726969659328461
              Training Euclidean Shift: 0.054669395089149475	 Val Euclidean Shift: 0.05837584137916565


Epoch 530/1200: Training Loss: 0.019933953881263733		 Val Loss: 0.05419647693634033
		Training MAE Angle: 0.04012454301118851		 Val MAE Angle: 0.08208159804344177
              Training MSE Angle: 0.0033032468054443598		 Val MSE Angle: 0.009870081394910812
		Training MAE Shift: 0.03136178106069565		 Val MAE Shift: 0.05272252559661865
              Training Euclidean Shift: 0.04917892813682556	 Val Euclidean Shift: 0.08176051378250122


Epoch 531/1200: Training Loss: 0.020245883613824844		 Val Loss: 0.032804861664772034
		Training MAE Angle: 0.034571051597595215		 Val MAE Angle: 0.035654693841934204
              Training MSE Angle: 0.0019059419864788651		 Val MSE Angle: 0.0025510260835289954
		Training MAE Shift: 0.032320618629455566		 Val MAE Shift: 0.03190156519412994
              Training Euclidean Shift: 0.050835952162742615	 Val Euclidean Shift: 0.050410717725753784


Epoch 532/1200: Training Loss: 0.015216410160064697		 Val Loss: 0.01976982653141022
		Training MAE Angle: 0.033406153321266174		 Val MAE Angle: 0.032161545753479
              Training MSE Angle: 0.0020697899162769318		 Val MSE Angle: 0.003562093526124954
		Training MAE Shift: 0.027376029640436172		 Val MAE Shift: 0.028522020578384398
              Training Euclidean Shift: 0.04310928285121918	 Val Euclidean Shift: 0.04537651538848877


Epoch 533/1200: Training Loss: 0.019631093367934227		 Val Loss: 0.07714983224868774
		Training MAE Angle: 0.03899644687771797		 Val MAE Angle: 0.10226209163665771
              Training MSE Angle: 0.0029605901800096035		 Val MSE Angle: 0.014869001507759095
		Training MAE Shift: 0.029668796807527542		 Val MAE Shift: 0.060978806018829344
              Training Euclidean Shift: 0.0469881035387516	 Val Euclidean Shift: 0.09677250981330872


Epoch 534/1200: Training Loss: 0.01623329147696495		 Val Loss: 0.044315454363822934
		Training MAE Angle: 0.04004290699958801		 Val MAE Angle: 0.08704209923744202
              Training MSE Angle: 0.0033904716838151217		 Val MSE Angle: 0.01825241595506668
		Training MAE Shift: 0.025930102914571762		 Val MAE Shift: 0.034898942708969115
              Training Euclidean Shift: 0.04100211709737778	 Val Euclidean Shift: 0.054497963190078734


Epoch 535/1200: Training Loss: 0.013595975004136562		 Val Loss: 0.03500979542732239
		Training MAE Angle: 0.03423561528325081		 Val MAE Angle: 0.08654818534851075
              Training MSE Angle: 0.002097845310345292		 Val MSE Angle: 0.010822151601314545
		Training MAE Shift: 0.023714112117886543		 Val MAE Shift: 0.03729389905929566
              Training Euclidean Shift: 0.037046823650598526	 Val Euclidean Shift: 0.05769163370132446


Epoch 536/1200: Training Loss: 0.013905834406614304		 Val Loss: 0.017219506204128265
		Training MAE Angle: 0.03899771720170975		 Val MAE Angle: 0.035635370016098025
              Training MSE Angle: 0.0026257606223225594		 Val MSE Angle: 0.0022307494655251503
		Training MAE Shift: 0.024357806891202927		 Val MAE Shift: 0.026769110560417177
              Training Euclidean Shift: 0.03850817307829857	 Val Euclidean Shift: 0.04223823547363281


Epoch 537/1200: Training Loss: 0.016330981627106667		 Val Loss: 0.032274818420410155
		Training MAE Angle: 0.03545155003666878		 Val MAE Angle: 0.032165950536727904
              Training MSE Angle: 0.002396634314209223		 Val MSE Angle: 0.002678481675684452
		Training MAE Shift: 0.025834476575255394		 Val MAE Shift: 0.04054645299911499
              Training Euclidean Shift: 0.04017675668001175	 Val Euclidean Shift: 0.06375584602355958


Epoch 538/1200: Training Loss: 0.01625804603099823		 Val Loss: 0.02142791748046875
		Training MAE Angle: 0.0349278524518013		 Val MAE Angle: 0.0316473126411438
              Training MSE Angle: 0.0030317562632262707		 Val MSE Angle: 0.0025779105722904204
		Training MAE Shift: 0.027304720133543015		 Val MAE Shift: 0.02862338423728943
              Training Euclidean Shift: 0.042796552181243896	 Val Euclidean Shift: 0.04502384662628174


Epoch 539/1200: Training Loss: 0.019771333783864975		 Val Loss: 0.03015652596950531
		Training MAE Angle: 0.039569366723299026		 Val MAE Angle: 0.06173954606056213
              Training MSE Angle: 0.0034275909420102835		 Val MSE Angle: 0.007673563808202744
		Training MAE Shift: 0.02872433513402939		 Val MAE Shift: 0.029470637440681458
              Training Euclidean Shift: 0.04542284831404686	 Val Euclidean Shift: 0.046247446537017824


Epoch 540/1200: Training Loss: 0.020638832822442055		 Val Loss: 0.012420827895402909
		Training MAE Angle: 0.04299500584602356		 Val MAE Angle: 0.03894752860069275
              Training MSE Angle: 0.0029641911387443542		 Val MSE Angle: 0.0025900684297084807
		Training MAE Shift: 0.028725452721118927		 Val MAE Shift: 0.02073454111814499
              Training Euclidean Shift: 0.04518752545118332	 Val Euclidean Shift: 0.03260422050952912


Epoch 541/1200: Training Loss: 0.04326898604631424		 Val Loss: 0.047585895657539366
		Training MAE Angle: 0.037595223635435104		 Val MAE Angle: 0.03485612273216247
              Training MSE Angle: 0.0067201657220721245		 Val MSE Angle: 0.007087606191635132
		Training MAE Shift: 0.02730955183506012		 Val MAE Shift: 0.03991725444793701
              Training Euclidean Shift: 0.043302807956933975	 Val Euclidean Shift: 0.0639651358127594


Epoch 542/1200: Training Loss: 0.02007940784096718		 Val Loss: 0.03591531813144684
		Training MAE Angle: 0.037232063710689545		 Val MAE Angle: 0.0410973072052002
              Training MSE Angle: 0.0035247779451310635		 Val MSE Angle: 0.0037034198641777037
		Training MAE Shift: 0.030183184891939163		 Val MAE Shift: 0.0357856035232544
              Training Euclidean Shift: 0.04751642048358917	 Val Euclidean Shift: 0.05702009201049805


Epoch 543/1200: Training Loss: 0.018902160227298737		 Val Loss: 0.03860246539115906
		Training MAE Angle: 0.03454412519931793		 Val MAE Angle: 0.040045741200447085
              Training MSE Angle: 0.0019951111171394587		 Val MSE Angle: 0.0041374295949935915
		Training MAE Shift: 0.029249172657728195		 Val MAE Shift: 0.03861398696899414
              Training Euclidean Shift: 0.046750567853450775	 Val Euclidean Shift: 0.0605755090713501


Epoch 544/1200: Training Loss: 0.021914329379796982		 Val Loss: 0.037178120017051695
		Training MAE Angle: 0.03557857871055603		 Val MAE Angle: 0.04344483017921448
              Training MSE Angle: 0.00356987863779068		 Val MSE Angle: 0.005143328383564949
		Training MAE Shift: 0.03128498047590256		 Val MAE Shift: 0.038658621907234195
              Training Euclidean Shift: 0.04964892566204071	 Val Euclidean Shift: 0.060138165950775146


Epoch 545/1200: Training Loss: 0.01820836029946804		 Val Loss: 0.044933241605758664
		Training MAE Angle: 0.03378996625542641		 Val MAE Angle: 0.0429193377494812
              Training MSE Angle: 0.0020838789641857147		 Val MSE Angle: 0.008841753005981445
		Training MAE Shift: 0.030278220772743225		 Val MAE Shift: 0.02745111584663391
              Training Euclidean Shift: 0.047440703958272934	 Val Euclidean Shift: 0.043356379866600035


Epoch 546/1200: Training Loss: 0.02064679004251957		 Val Loss: 0.026079851388931274
		Training MAE Angle: 0.03253708407282829		 Val MAE Angle: 0.029468777775764465
              Training MSE Angle: 0.002033667638897896		 Val MSE Angle: 0.0020029017701745032
		Training MAE Shift: 0.026911769062280655		 Val MAE Shift: 0.0331024169921875
              Training Euclidean Shift: 0.042706772685050964	 Val Euclidean Shift: 0.052337241172790525


Epoch 547/1200: Training Loss: 0.02270086109638214		 Val Loss: 0.029233318567276
		Training MAE Angle: 0.03641333058476448		 Val MAE Angle: 0.03577635288238525
              Training MSE Angle: 0.0044114794582128525		 Val MSE Angle: 0.0025395121425390243
		Training MAE Shift: 0.030008578673005104		 Val MAE Shift: 0.03130979537963867
              Training Euclidean Shift: 0.047419410198926926	 Val Euclidean Shift: 0.04943103194236755


Epoch 548/1200: Training Loss: 0.03015405870974064		 Val Loss: 0.021905912458896636
		Training MAE Angle: 0.03941016644239426		 Val MAE Angle: 0.03658542037010193
              Training MSE Angle: 0.0028823381289839745		 Val MSE Angle: 0.003406185284256935
		Training MAE Shift: 0.03786597028374672		 Val MAE Shift: 0.03207918405532837
              Training Euclidean Shift: 0.05946950986981392	 Val Euclidean Shift: 0.050465166568756104


Epoch 549/1200: Training Loss: 0.025033360347151756		 Val Loss: 0.048182365298271176
		Training MAE Angle: 0.04126445949077606		 Val MAE Angle: 0.07503038048744201
              Training MSE Angle: 0.005158419720828533		 Val MSE Angle: 0.012466641515493393
		Training MAE Shift: 0.031580518931150436		 Val MAE Shift: 0.04658343493938446
              Training Euclidean Shift: 0.049916822463274	 Val Euclidean Shift: 0.07227777242660523


Epoch 550/1200: Training Loss: 0.020072313025593758		 Val Loss: 0.03958489596843719
		Training MAE Angle: 0.04034332185983658		 Val MAE Angle: 0.0877372145652771
              Training MSE Angle: 0.0038230768404901028		 Val MSE Angle: 0.012817633152008057
		Training MAE Shift: 0.03025858849287033		 Val MAE Shift: 0.03879146873950958
              Training Euclidean Shift: 0.0485147163271904	 Val Euclidean Shift: 0.06086850166320801


Epoch 551/1200: Training Loss: 0.024376440793275833		 Val Loss: 0.04606817364692688
		Training MAE Angle: 0.038458775728940964		 Val MAE Angle: 0.05250447988510132
              Training MSE Angle: 0.00474297720938921		 Val MSE Angle: 0.006160534918308258
		Training MAE Shift: 0.03270820528268814		 Val MAE Shift: 0.048161834478378296
              Training Euclidean Shift: 0.05065099149942398	 Val Euclidean Shift: 0.07579652070999146


Epoch 552/1200: Training Loss: 0.021290399134159088		 Val Loss: 0.035999664664268495
		Training MAE Angle: 0.037611059844493866		 Val MAE Angle: 0.04686678946018219
              Training MSE Angle: 0.00278103188611567		 Val MSE Angle: 0.003984471410512924
		Training MAE Shift: 0.031634341925382614		 Val MAE Shift: 0.04504304230213165
              Training Euclidean Shift: 0.049388233572244644	 Val Euclidean Shift: 0.06955877542495728


Epoch 553/1200: Training Loss: 0.018751997500658035		 Val Loss: 0.03127624988555908
		Training MAE Angle: 0.034248679876327515		 Val MAE Angle: 0.03698917925357818
              Training MSE Angle: 0.0027314769104123116		 Val MSE Angle: 0.007041028141975403
		Training MAE Shift: 0.029140163213014603		 Val MAE Shift: 0.03531041145324707
              Training Euclidean Shift: 0.045869387686252594	 Val Euclidean Shift: 0.05484969615936279


Epoch 554/1200: Training Loss: 0.02311098948121071		 Val Loss: 0.03069385588169098
		Training MAE Angle: 0.037335965782403946		 Val MAE Angle: 0.04453549981117248
              Training MSE Angle: 0.005907383747398853		 Val MSE Angle: 0.004152872413396835
		Training MAE Shift: 0.03051130101084709		 Val MAE Shift: 0.03467857837677002
              Training Euclidean Shift: 0.04791855067014694	 Val Euclidean Shift: 0.05454962253570557


Epoch 555/1200: Training Loss: 0.01710248924791813		 Val Loss: 0.031149524450302123
		Training MAE Angle: 0.04032708704471588		 Val MAE Angle: 0.07566521763801574
              Training MSE Angle: 0.0038288170471787453		 Val MSE Angle: 0.008536436408758164
		Training MAE Shift: 0.026472192257642746		 Val MAE Shift: 0.03674005270004273
              Training Euclidean Shift: 0.041571032255887985	 Val Euclidean Shift: 0.057569438219070436


Epoch 556/1200: Training Loss: 0.018541859462857246		 Val Loss: 0.057084470987319946
		Training MAE Angle: 0.03669082373380661		 Val MAE Angle: 0.04756997227668762
              Training MSE Angle: 0.0021183963399380445		 Val MSE Angle: 0.011057984083890915
		Training MAE Shift: 0.02933342568576336		 Val MAE Shift: 0.05403701663017273
              Training Euclidean Shift: 0.046292707324028015	 Val Euclidean Shift: 0.08324548602104187


Epoch 557/1200: Training Loss: 0.02198980003595352		 Val Loss: 0.0348515659570694
		Training MAE Angle: 0.03593241050839424		 Val MAE Angle: 0.03714191913604736
              Training MSE Angle: 0.0032087573781609535		 Val MSE Angle: 0.0065641053020954136
		Training MAE Shift: 0.02857797220349312		 Val MAE Shift: 0.0351375550031662
              Training Euclidean Shift: 0.04618501663208008	 Val Euclidean Shift: 0.05492105484008789


Epoch 558/1200: Training Loss: 0.0245712548494339		 Val Loss: 0.018401080369949342
		Training MAE Angle: 0.033928316086530685		 Val MAE Angle: 0.031934487819671634
              Training MSE Angle: 0.0028004893101751804		 Val MSE Angle: 0.003149513527750969
		Training MAE Shift: 0.029651759192347527		 Val MAE Shift: 0.02538841962814331
              Training Euclidean Shift: 0.04633483290672302	 Val Euclidean Shift: 0.03986363410949707


Epoch 559/1200: Training Loss: 0.016025085002183914		 Val Loss: 0.033003422617912295
		Training MAE Angle: 0.033997658640146255		 Val MAE Angle: 0.057415688037872316
              Training MSE Angle: 0.0023524826392531395		 Val MSE Angle: 0.007233741879463196
		Training MAE Shift: 0.027264976873993874		 Val MAE Shift: 0.03775721788406372
              Training Euclidean Shift: 0.04231420159339905	 Val Euclidean Shift: 0.05902343988418579


Epoch 560/1200: Training Loss: 0.026396621018648148		 Val Loss: 0.06068533658981323
		Training MAE Angle: 0.04468650743365288		 Val MAE Angle: 0.09773945808410645
              Training MSE Angle: 0.006531831808388233		 Val MSE Angle: 0.015700532495975493
		Training MAE Shift: 0.03149893879890442		 Val MAE Shift: 0.049074819684028624
              Training Euclidean Shift: 0.049919337034225464	 Val Euclidean Shift: 0.07608481049537659


Epoch 561/1200: Training Loss: 0.02335662581026554		 Val Loss: 0.02972911298274994
		Training MAE Angle: 0.03993187099695206		 Val MAE Angle: 0.05961483716964722
              Training MSE Angle: 0.0027432383503764868		 Val MSE Angle: 0.006238595768809319
		Training MAE Shift: 0.03350299596786499		 Val MAE Shift: 0.035736110806465146
              Training Euclidean Shift: 0.05198045074939728	 Val Euclidean Shift: 0.05550393462181091


Epoch 562/1200: Training Loss: 0.02177593484520912		 Val Loss: 0.050579953193664554
		Training MAE Angle: 0.04597640410065651		 Val MAE Angle: 0.07952936887741088
              Training MSE Angle: 0.0037974873557686806		 Val MSE Angle: 0.013849203288555146
		Training MAE Shift: 0.0296389888972044		 Val MAE Shift: 0.047736340761184694
              Training Euclidean Shift: 0.04683421179652214	 Val Euclidean Shift: 0.07329473495483399


Epoch 563/1200: Training Loss: 0.041202057152986526		 Val Loss: 0.028453195095062257
		Training MAE Angle: 0.04076134413480759		 Val MAE Angle: 0.037660256028175354
              Training MSE Angle: 0.004898581188172102		 Val MSE Angle: 0.0036509577184915543
