nohup: ignoring input
/home/alonkay/conda/alon/lib/python3.9/site-packages/torch/cuda/__init__.py:128: UserWarning: CUDA initialization: Unexpected error from cudaGetDeviceCount(). Did you run some cuda functions before calling NumCudaDevices() that might have already set an error? Error 805: MPS client failed to connect to the MPS control daemon or the MPS server (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
  return torch._C._cuda_getDeviceCount() > 0
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/utils/generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
/home/alonkay/conda/alon/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/alonkay/conda/alon/lib/python3.9/site-packages/transformers/modeling_utils.py:479: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location=map_location)
###########################################################################################################################################################

                         learning rate: 0.0001, lr_decay: 0.8, mlp_hidden_sizes: [1024, 512], jump_frames: 2, use_reconstruction_layer: True
                        batch_size: 8, norm: True, train_seqeunces: [0, 2, 3, 5], val_sequences: [6, 7, 8], dataset: Stereo,
                        average embeddings: False, model: openai/clip-vit-base-patch32, augmentation: True, random crop: True, deepF_nocorrs: False, part: mid, get_old_path: False,
                        SVD coeff: 0, RE1 coeff: 0 SED coeff: 0.5, ALG_COEFF: 0, L2_coeff: 1, huber_coeff: 1, frozen layers: 4, trained vit: None,
                        crop: 224 resize: 256, use conv: False pretrained: None, data_ratio: 0.1, norm_mean: tensor([0.4815, 0.4578, 0.4082]), norm_std: tensor([0.2686, 0.2613, 0.2758]), sched: None seed: 200, 


algebraic_truth: 0.0167390458724078		 val_algebraic_truth: 0.017267291960508926
RE1_truth: 0.00018920101608861894		 val_RE1_truth: 0.00020104535328953162
SED_truth: 0.00151348059229991		 val_SED_truth: 0.0016083680093288422


Epoch 1/4001: Training Loss: 3726.8005514705883		 Val Loss: 2654.7550951086955
             Training MAE: 0.3285462558269501		 Val MAE: 0.3212648332118988
             Algebraic dist: 706.9416360294117		 Val Algebraic dist: 24.606668223505434
             RE1 dist: 3704326.588235294		 Val RE1 dist: 912.4487092391304
             SED dist: 7452.659926470588		 Val SED dist: 5308.555027173913


Epoch 2/4001: Training Loss: 930.1021943933823		 Val Loss: 6.109802909519361
             Training MAE: 0.33462029695510864		 Val MAE: 0.32183051109313965
             Algebraic dist: 47.497138528262866		 Val Algebraic dist: 70.37839143172555
             RE1 dist: 6798.927389705882		 Val RE1 dist: 6899.587635869565
             SED dist: 1859.2859604779412		 Val SED dist: 11.687251878821332


Epoch 3/4001: Training Loss: 2.579393947825712		 Val Loss: 5.687496019446331
             Training MAE: 0.27757957577705383		 Val MAE: 0.2339838296175003
             Algebraic dist: 57.675271426930145		 Val Algebraic dist: 62.88460109544837
             RE1 dist: 4038.278033088235		 Val RE1 dist: 5404.071671195652
             SED dist: 4.743442759794347		 Val SED dist: 11.096152264138926


Epoch 4/4001: Training Loss: 2.7588121750775505		 Val Loss: 4.9318064814028535
             Training MAE: 0.2556939125061035		 Val MAE: 0.22917965054512024
             Algebraic dist: 69.10944680606617		 Val Algebraic dist: 63.26355511209239
             RE1 dist: 5689.344209558823		 Val RE1 dist: 4857.496942934783
             SED dist: 5.1815284280216		 Val SED dist: 9.60077435037364


Epoch 5/4001: Training Loss: 2.2245429543887867		 Val Loss: 4.436531398607337
             Training MAE: 0.23800908029079437		 Val MAE: 0.23535549640655518
             Algebraic dist: 57.828606100643384		 Val Algebraic dist: 76.95036514945652
             RE1 dist: 4026.7826286764707		 Val RE1 dist: 7317.249320652174
             SED dist: 4.1618203555836395		 Val SED dist: 8.600232331649117


Epoch 6/4001: Training Loss: 2.498935250674977		 Val Loss: 5.07172095257303
             Training MAE: 0.23571692407131195		 Val MAE: 0.22035038471221924
             Algebraic dist: 66.22206744025735		 Val Algebraic dist: 79.6082179857337
             RE1 dist: 4926.097426470588		 Val RE1 dist: 7938.426630434783
             SED dist: 4.720100402832031		 Val SED dist: 9.90094524881114


Epoch 7/4001: Training Loss: 2.3930509230669808		 Val Loss: 4.664212102475374
             Training MAE: 0.2339693307876587		 Val MAE: 0.2376832365989685
             Algebraic dist: 63.78787051930147		 Val Algebraic dist: 79.1801173997962
             RE1 dist: 4706.670955882353		 Val RE1 dist: 7080.32472826087
             SED dist: 4.513529160443475		 Val SED dist: 9.057507058848506


Epoch 8/4001: Training Loss: 2.529852025649127		 Val Loss: 5.23213063115659
             Training MAE: 0.2365047037601471		 Val MAE: 0.22746124863624573
             Algebraic dist: 68.68777286305146		 Val Algebraic dist: 85.74991508152173
             RE1 dist: 5330.366268382353		 Val RE1 dist: 10050.528532608696
             SED dist: 4.78048391903148		 Val SED dist: 10.21000273331352


Epoch 9/4001: Training Loss: 2.04479419483858		 Val Loss: 4.765018960703975
             Training MAE: 0.2229536920785904		 Val MAE: 0.25661447644233704
             Algebraic dist: 58.66270536534927		 Val Algebraic dist: 111.87452233355978
             RE1 dist: 4145.2109375		 Val RE1 dist: 12985.767663043478
             SED dist: 3.839445675120634		 Val SED dist: 9.202582317849863


Epoch 10/4001: Training Loss: 2.1019280377556298		 Val Loss: 5.716331813646399
             Training MAE: 0.2209821343421936		 Val MAE: 0.22238469123840332
             Algebraic dist: 59.39338594324448		 Val Algebraic dist: 85.4832179857337
             RE1 dist: 4012.5445772058824		 Val RE1 dist: 10925.20652173913
             SED dist: 3.9598859899184284		 Val SED dist: 11.191442074983016


Epoch 11/4001: Training Loss: 2.230304718017578		 Val Loss: 13.19375875721807
             Training MAE: 0.22550368309020996		 Val MAE: 0.23759794235229492
             Algebraic dist: 63.81390739889706		 Val Algebraic dist: 145.45801842730978
             RE1 dist: 4581.56387867647		 Val RE1 dist: 25181.26358695652
             SED dist: 4.2106789981617645		 Val SED dist: 26.11968463400136


Epoch 12/4001: Training Loss: 2.8821927238913143		 Val Loss: 5.268222974694294
             Training MAE: 0.23257631063461304		 Val MAE: 0.233899787068367
             Algebraic dist: 74.00045955882354		 Val Algebraic dist: 99.41251273777173
             RE1 dist: 6365.909466911765		 Val RE1 dist: 14679.551630434782
             SED dist: 5.498949836282169		 Val SED dist: 10.26599651834239


Epoch 13/4001: Training Loss: 1.92279613719267		 Val Loss: 6.340519117272419
             Training MAE: 0.21757124364376068		 Val MAE: 0.20603153109550476
             Algebraic dist: 57.02603687959559		 Val Algebraic dist: 85.22181768002717
             RE1 dist: 3902.737591911765		 Val RE1 dist: 10982.646739130434
             SED dist: 3.607685313505285		 Val SED dist: 12.466405453889266


Epoch 14/4001: Training Loss: 2.0350429310518154		 Val Loss: 4.706880652386209
             Training MAE: 0.21296606957912445		 Val MAE: 0.22612689435482025
             Algebraic dist: 56.96765495749081		 Val Algebraic dist: 85.31151282269022
             RE1 dist: 3695.341681985294		 Val RE1 dist: 8513.644701086956
             SED dist: 3.8426114250631893		 Val SED dist: 9.169145003609035


Epoch 15/4001: Training Loss: 2.1045866573558136		 Val Loss: 5.617066093113111
             Training MAE: 0.21236075460910797		 Val MAE: 0.20669913291931152
             Algebraic dist: 58.70481962316177		 Val Algebraic dist: 81.64308232846467
             RE1 dist: 3920.541819852941		 Val RE1 dist: 9214.315217391304
             SED dist: 3.983685661764706		 Val SED dist: 11.02225461213485


Epoch 16/4001: Training Loss: 2.2354888916015625		 Val Loss: 4.847203462020211
             Training MAE: 0.21299175918102264		 Val MAE: 0.22027750313282013
             Algebraic dist: 61.75264964384191		 Val Algebraic dist: 86.11143958050272
             RE1 dist: 4367.441176470588		 Val RE1 dist: 10019.819972826086
             SED dist: 4.242649302763097		 Val SED dist: 9.459357220193613


Epoch 17/4001: Training Loss: 1.9525570588953354		 Val Loss: 4.478553440259851
             Training MAE: 0.20567865669727325		 Val MAE: 0.2197341024875641
             Algebraic dist: 55.698005227481616		 Val Algebraic dist: 81.73641835088316
             RE1 dist: 3543.542279411765		 Val RE1 dist: 8467.932065217392
             SED dist: 3.691752489875345		 Val SED dist: 8.7234470Epoch 18/4001: Training Loss: 2.667818181654986		 Val Loss: 4.673258905825407
             Training MAE: 0.2033187299966812		 Val MAE: 0.21928200125694275
             Algebraic dist: 73.92542940027573		 Val Algebraic dist: 88.77310313349184
             RE1 dist: 6207.780330882353		 Val RE1 dist: 8101.555027173913
             SED dist: 5.114199470071232		 Val SED dist: 9.111403755519701


Epoch 19/4001: Training Loss: 1.9742770475499771		 Val Loss: 4.570123091987941
             Training MAE: 0.20103521645069122		 Val MAE: 0.194287970662117
             Algebraic dist: 59.214832979090076		 Val Algebraic dist: 85.79894488790761
             RE1 dist: 3960.8166360294117		 Val RE1 dist: 8699.40625
             SED dist: 3.7408846686868107		 Val SED dist: 8.936663420304008


Epoch 20/4001: Training Loss: 2.076679229736328		 Val Loss: 4.738431515900985
             Training MAE: 0.1951233148574829		 Val MAE: 0.2071043699979782
             Algebraic dist: 62.53116383272059		 Val Algebraic dist: 85.11214546535327
             RE1 dist: 4507.654411764706		 Val RE1 dist: 8928.42866847826
             SED dist: 3.952257044175092		 Val SED dist: 9.260912687882133


Epoch 21/4001: Training Loss: 2.2519991257611442		 Val Loss: 6.088836669921875
             Training MAE: 0.1937151998281479		 Val MAE: 0.2028377652168274
             Algebraic dist: 59.885081571691174		 Val Algebraic dist: 102.53834069293478
             RE1 dist: 4001.329044117647		 Val RE1 dist: 15026.203804347826
             SED dist: 4.302300397087546		 Val SED dist: 11.963174571161685


Epoch 22/4001: Training Loss: 2.057110954733456		 Val Loss: 4.841353043265965
             Training MAE: 0.19059637188911438		 Val MAE: 0.18379169702529907
             Algebraic dist: 60.630026424632355		 Val Algebraic dist: 91.8622516134511
             RE1 dist: 4260.809742647059		 Val RE1 dist: 10396.572010869566
             SED dist: 3.922449897317325		 Val SED dist: 9.48986352008322


Epoch 23/4001: Training Loss: 1.7560569538789637		 Val Loss: 5.808071634043818
             Training MAE: 0.1848403364419937		 Val MAE: 0.1948678344488144
             Algebraic dist: 53.686961454503674		 Val Algebraic dist: 84.92737877887228
             RE1 dist: 3321.590533088235		 Val RE1 dist: 10248.75
             SED dist: 3.3289561552159928		 Val SED dist: 11.420891803243887


Epoch 24/4001: Training Loss: 1.831435708438649		 Val Loss: 7.672963681428329
             Training MAE: 0.18287526071071625		 Val MAE: 0.24345983564853668
             Algebraic dist: 52.9886474609375		 Val Algebraic dist: 119.6501995584239
             RE1 dist: 3314.7435661764707		 Val RE1 dist: 19366.654891304348
             SED dist: 3.483373529770795		 Val SED dist: 15.068752122961957


Epoch 25/4001: Training Loss: 1.8464017755845015		 Val Loss: 4.521932187287704
             Training MAE: 0.1813472956418991		 Val MAE: 0.21579167246818542
             Algebraic dist: 55.17750459558823		 Val Algebraic dist: 77.9894488790761
             RE1 dist: 3567.919806985294		 Val RE1 dist: 7339.082201086957
             SED dist: 3.516081866096048		 Val SED dist: 8.817950041397758


Epoch 26/4001: Training Loss: 1.9138369840734146		 Val Loss: 5.381481668223506
             Training MAE: 0.18298903107643127		 Val MAE: 0.2068958729505539
             Algebraic dist: 54.22230440027573		 Val Algebraic dist: 91.83635147758152
             RE1 dist: 3396.873851102941		 Val RE1 dist: 12303.205163043478
             SED dist: 3.6490213730755974		 Val SED dist: 10.54572063943614


Epoch 27/4001: Training Loss: 1.797429365270278		 Val Loss: 5.224718508513077
             Training MAE: 0.1728191077709198		 Val MAE: 0.21397888660430908
             Algebraic dist: 52.10822969324448		 Val Algebraic dist: 93.22646696671195
             RE1 dist: 3272.465992647059		 Val RE1 dist: 8182.733695652174
             SED dist: 3.4303620282341454		 Val SED dist: 10.226382711659307


Epoch 28/4001: Training Loss: 2.2172878489774814		 Val Loss: 4.172459477963655
             Training MAE: 0.18095135688781738		 Val MAE: 0.17247675359249115
             Algebraic dist: 58.26757453469669		 Val Algebraic dist: 77.60746964164402
             RE1 dist: 3919.057904411765		 Val RE1 dist: 7252.954483695652
             SED dist: 4.259049808277803		 Val SED dist: 8.179406207540762


Epoch 29/4001: Training Loss: 1.7500038146972656		 Val Loss: 6.293401303498642
             Training MAE: 0.16971653699874878		 Val MAE: 0.18471693992614746
             Algebraic dist: 50.69314036649816		 Val Algebraic dist: 106.00779127038044
             RE1 dist: 2958.744944852941		 Val RE1 dist: 15260.30570652174
             SED dist: 3.3426890653722428		 Val SED dist: 12.403953220533287


Epoch 30/4001: Training Loss: 1.6708529977237476		 Val Loss: 4.290594681449559
             Training MAE: 0.17000383138656616		 Val MAE: 0.16917811334133148
             Algebraic dist: 48.43881764131434		 Val Algebraic dist: 86.5390094259511
             RE1 dist: 2712.9802389705883		 Val RE1 dist: 9107.118885869566
             SED dist: 3.182399300967946		 Val SED dist: 8.409176370371943


Epoch 31/4001: Training Loss: 1.7553749084472656		 Val Loss: 4.840752974800441
             Training MAE: 0.16924583911895752		 Val MAE: 0.1500200778245926
             Algebraic dist: 50.637138815487134		 Val Algebraic dist: 65.9588092306386
             RE1 dist: 2890.978400735294		 Val RE1 dist: 6178.490489130435
             SED dist: 3.3526918747845817		 Val SED dist: 9.550665813943613


Epoch 32/4001: Training Loss: 1.8866920471191406		 Val Loss: 5.099877398947011
             Training MAE: 0.17453926801681519		 Val MAE: 0.15420249104499817
             Algebraic dist: 51.054920869715076		 Val Algebraic dist: 74.60624893851902
             RE1 dist: 3031.9604779411766		 Val RE1 dist: 6060.281929347826
             SED dist: 3.6067836985868564		 Val SED dist: 10.06289407481318


Epoch 33/4001: Training Loss: 1.6217692880069507		 Val Loss: 4.975590913192086
             Training MAE: 0.1645801067352295		 Val MAE: 0.18696147203445435
             Algebraic dist: 46.23424933938419		 Val Algebraic dist: 75.5098346212636
             RE1 dist: 2476.647288602941		 Val RE1 dist: 7583.152173913043
             SED dist: 3.092602898092831		 Val SED dist: 9.772821177606998


Epoch 34/4001: Training Loss: 1.5941053278305952		 Val Loss: 4.376063139542289
             Training MAE: 0.16337089240550995		 Val MAE: 0.16770796477794647
             Algebraic dist: 44.79015754250919		 Val Algebraic dist: 61.244681980298914
             RE1 dist: 2369.197150735294		 Val RE1 dist: 4346.225203804348
             SED dist: 3.0403525408576515		 Val SED dist: 8.602331410283627


Epoch 35/4001: Training Loss: 1.5800572563620174		 Val Loss: 5.247245788574219
             Training MAE: 0.16466261446475983		 Val MAE: 0.20303122699260712
             Algebraic dist: 44.8280819163603		 Val Algebraic dist: 80.82375700577445
             RE1 dist: 2327.791819852941		 Val RE1 dist: 10067.088315217392
             SED dist: 3.0110049528234146		 Val SED dist: 10.288632600203805


Epoch 36/4001: Training Loss: 1.621386584113626		 Val Loss: 4.29573622993801
             Training MAE: 0.16398318111896515		 Val MAE: 0.1714981198310852
             Algebraic dist: 44.624885110294116		 Val Algebraic dist: 64.55286706012228
             RE1 dist: 2416.091911764706		 Val RE1 dist: 4821.439198369565
             SED dist: 3.094735762652229		 Val SED dist: 8.43960305918818


Epoch 37/4001: Training Loss: 1.6328843060661764		 Val Loss: 4.228565381920856
             Training MAE: 0.16390439867973328		 Val MAE: 0.1415744423866272
             Algebraic dist: 44.45443905101103		 Val Algebraic dist: 64.64341669497283
             RE1 dist: 2249.537913602941		 Val RE1 dist: 4457.6484375
             SED dist: 3.1175539353314567		 Val SED dist: 8.341751762058424


6


t: 10.800084653108016


al SED dist: 9.521018650220787


